<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chat Interface</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            background-color: #f0f0f0; /* สีพื้นหลังเริ่มต้น (เพื่อความปลอดภัย) */
        }
        .container {
            width: 800px;
            height: 620px;
            background-color: #fffacd; /* สีเหลืองพาสเทล */
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        #ai-title {
            font-size: 28px;
            text-shadow: 2px 2px 4px #00000030, 4px 4px 6px #00000020;
            margin-bottom: 20px;
            white-space: nowrap;
            text-align: center; /* จัดกลางข้อความ */
        }
         #xdisplay {
            width: 100%;
            height: 400px;
            border: 1px solid #222; /* เส้นขอบเข้มขึ้น */
            border-radius: 5px;
            overflow-y: scroll;
            padding: 10px;
            margin-bottom: 10px;
            font-family: monospace;
            background-color: #000;
            color: #0f0; /* สีเขียว */
            font-size: 16px; /* ขนาดตัวอักษร */
            line-height: 1.5; /* ระยะห่างระหว่างบรรทัด */
            white-space: pre-wrap; /* แสดงผลการขึ้นบรรทัดใหม่ */
             box-sizing: border-box;
        }
        #xprompt {
            width: 100%;
             border: 1px solid #222; /* เส้นขอบเข้มขึ้น */
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
            font-family: monospace;
            background-color: #000;
            color: #ffbf00; /* สีอำพัน */
            box-sizing: border-box;
        }
        .button {
            margin: 5px;
            border-radius: 5px;
        }
        .gradient-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        .button-container {
            display: flex;
            justify-content: center;
             width: 100%;
        }

    </style>
</head>
<body>
    <div class="gradient-background"></div>
    <div class="container">
        <div id="ai-title">AI Chat Interface</div>
        <div id="xdisplay"></div>
        <input type="text" id="xprompt" placeholder="พิมพ์ข้อความ...">
        <div class="button-container">
           <button class="button is-primary" id="submitBtn">Submit</button>
            <button class="button" id="clearBtn">Clear</button>
        </div>
    </div>
    <script>
        const aiTitle = document.getElementById('ai-title');
        const colors = ['red', 'orange', 'green', 'purple'];
        let colorIndex = 0;

        function changeColor() {
            aiTitle.style.color = colors[colorIndex];
            colorIndex = (colorIndex + 1) % colors.length;
        }
        setInterval(changeColor, 500);

        const xdisplay = document.getElementById('xdisplay');
        const xprompt = document.getElementById('xprompt');
        const submitBtn = document.getElementById('submitBtn');
        const clearBtn = document.getElementById('clearBtn');

        submitBtn.addEventListener('click', () => {
             const promptText = xprompt.value.trim();
            if (promptText !== '') {
               
                const newText = document.createElement('div');
                 newText.textContent = '> ' + promptText + '\n';
                 xdisplay.appendChild(newText);
                 xdisplay.scrollTop = xdisplay.scrollHeight; // Scroll to bottom
                
                 groq(promptText).then(response => {
                 const aiResponse = document.createElement('div');
                    aiResponse.textContent = 'AI: '+response + '\n';
                    xdisplay.appendChild(aiResponse);
                    xdisplay.scrollTop = xdisplay.scrollHeight;
            });
                 xprompt.value = '';
            }
        });
         clearBtn.addEventListener('click', () => {
             xdisplay.innerHTML = '';
             xprompt.value = '';
        });
        function randomPastelColor() {
             const r = Math.floor(Math.random() * 100 + 155); // 155-255
             const g = Math.floor(Math.random() * 100 + 155);
            const b = Math.floor(Math.random() * 100 + 155);
            return `rgb(${r}, ${g}, ${b})`;
        }
        function setButtonPastelColor(button) {
            button.style.backgroundColor = randomPastelColor();
        }
        setButtonPastelColor(submitBtn);
        setButtonPastelColor(clearBtn);

        // Background Gradient Animation
        const gradientBackground = document.querySelector('.gradient-background');
        let gradientIndex = 0;
        const gradientColors = [
            ['255, 0, 0', '255, 255, 0'], // Red -> Yellow
            ['255, 255, 0', '0, 255, 0'], // Yellow -> Green
            ['0, 255, 0', '0, 255, 255'], // Green -> Cyan
            ['0, 255, 255', '0, 0, 255'], // Cyan -> Blue
            ['0, 0, 255', '255, 0, 255'], // Blue -> Magenta
            ['255, 0, 255', '255, 0, 0']  // Magenta -> Red
        ];

        function setGradientBackground() {
            const [color1, color2] = gradientColors[gradientIndex];
            gradientBackground.style.background = `linear-gradient(45deg, rgba(${color1},0.8),rgba(${color2},0.8))`;
            gradientIndex = (gradientIndex + 1) % gradientColors.length;
        }
        setGradientBackground();
        setInterval(setGradientBackground, 3000);


        async function groq(message) {
           var apikey = “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”;
           var url = "https://api.groq.com/openai/v1/chat/completions";
           var nat = " แสดงผลภาษาไทย, ตอบคำถามเป็นภาษาไทยที่สุภาพ ";
           var headers = {
                "Content-Type": "application/json",
                "Authorization": "Bearer " + apikey
            };
             var payload = {
                "messages": [{"role": "user", "content": message+nat}], // ส่ง message ที่รับมาเป็น prompt
                 "model": “llama3-8b-8192”,
                "temperature": 1,
                "max_tokens": 1024,
                "top_p": 1,
                 // "stream": false, // ปิด stream สำหรับการใช้งานแบบง่าย
                 "stop": null
            };
            try{
                const response = await fetch(url, {
                   method: 'POST',
                   headers: headers,
                   body: JSON.stringify(payload)
               });
              if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`HTTP error ${response.status}: ${errorText}`);
                }
                 const jsonResponse = await response.json();
                if (jsonResponse && jsonResponse.choices && jsonResponse.choices.length > 0) {
                      return jsonResponse.choices[0].message.content;
                 } else {
                     throw new Error('Invalid response from API');
                 }
              } catch (error) {
                 console.error("Error from groq:", error);
                return "Error: " + error.message;
            }
        }

    </script>
</body>
</html>
